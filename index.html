<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AquaGuard Permit Checking Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:#0b1220;
  color:#e5e7eb;
}
.container{max-width:820px;margin:auto;padding:16px}
.banner img{width:100%;border-radius:14px}
.tabs{display:flex;gap:10px;margin-top:14px}
.tab{
  flex:1;padding:10px;text-align:center;
  border-radius:12px;background:#020617;
  border:1px solid #1f2937;cursor:pointer
}
.tab.active{background:#111827}
.card{background:#111827;border-radius:16px;padding:18px;margin-top:16px}
label{color:#9ca3af;font-size:14px}
input,select{
  width:100%;padding:12px;margin-top:6px;margin-bottom:14px;
  border-radius:10px;border:1px solid #374151;
  background:#020617;color:#fff
}
button{
  width:100%;padding:14px;border-radius:12px;
  border:none;background:#22c55e;
  color:#052e16;font-weight:700;cursor:pointer
}
.secondary{
  background:#020617;color:#e5e7eb;border:1px solid #374151
}
.status{margin-top:14px;padding:14px;border-radius:12px}
.yes{background:#064e3b}
.no{background:#052e16}
.maybe{background:#422006}
.conf-wrap{margin-top:10px}
.conf-bar{height:8px;border-radius:8px;background:#1f2937}
.conf-fill{height:8px;border-radius:8px;background:#22c55e;width:0%}
.hidden{display:none}
.footer{
  margin-top:30px;text-align:center;
  font-size:13px;color:#9ca3af
}
.footer img{width:90px;border-radius:50%;margin-top:10px}
a{color:#60a5fa}
small{color:#94a3b8}
</style>
</head>

<body>
<div class="container">

<!-- Banner -->
<div class="banner">
  <img src="aquaguard-logo.PNG" alt="AquaGuard Permit Checking Tool">
</div>

<!-- Tabs -->
<div class="tabs">
  <div class="tab active" onclick="showTab('checker',this)">Permit Checker</div>
  <div class="tab" onclick="showTab('instructions',this)">Instructions</div>
</div>

<!-- CHECKER -->
<div id="checker" class="card">

<label>Property Address / City / ZIP (Georgia only)</label>
<input id="address"
placeholder="AquaGuard Foundation Solutions, 375 Northridge Rd, Atlanta GA 30350">

<label>Service Type</label>
<select id="service">
  <option value="helical">Helical Piers</option>
  <option value="push">Push Piers</option>
  <option value="wall">Wall Anchors (All Types)</option>
  <option value="slab">Slab Piers (Exempt)</option>
</select>

<button onclick="checkPermit()">Check Permit</button>

<div id="result" class="status hidden"></div>

<div id="confidenceWrap" class="conf-wrap hidden">
  <small id="confidenceText"></small>
  <div class="conf-bar">
    <div id="confidenceFill" class="conf-fill"></div>
  </div>
</div>

<!-- qPublic -->
<button class="secondary" style="margin-top:14px"
onclick="window.open('https://qpublic.schneidercorp.com','_blank')">
Open qPublic (Parcel Verification)
</button>

<!-- RandyMajors -->
<button class="secondary" style="margin-top:10px"
onclick="window.open(
  'https://www.randymajors.org/countygmap?x=-84.0945740&y=32.8370637&cx=-84.1296100&cy=34.0845450&zoom=13&state=GA&onestate=show&labels=show&counties=show',
  '_blank'
)">
Open County Boundary Map (RandyMajors)
</button>

<p style="margin-top:10px">
<a href="Permit_Instructions_2026-01-22.pdf" target="_blank">
View Official AquaGuard Permit Instructions (PDF)
</a>
</p>

<hr style="margin:20px 0;border-color:#1f2937">

<h3>Export Permit Audit (PDF)</h3>

<label>Inspector Name (CFI)</label>
<input id="inspName" placeholder="Mr. Mustache">

<label>Inspector Initials</label>
<input id="inspInit" placeholder="MM">

<button onclick="exportPDF()">Generate PDF Audit</button>

</div>

<!-- INSTRUCTIONS -->
<div id="instructions" class="card hidden">
<h3>How This Tool Works</h3>
<ul>
  <li>Accepts a Georgia address, city, ZIP, or any combination.</li>
  <li>Service type is evaluated first (slab piers exempt).</li>
  <li>Known cities map directly to their county.</li>
  <li>ZIP codes are used as a fallback.</li>
</ul>

<h3>Confidence Levels</h3>
<ul>
  <li><strong>High:</strong> City and county clearly identified.</li>
  <li><strong>Medium:</strong> ZIP-based county inference.</li>
  <li><strong>Low:</strong> Manual parcel verification required.</li>
</ul>

<p>
<strong>Official Reference:</strong><br>
<a href="Permit_Instructions_2026-01-22.pdf" target="_blank">
Open AquaGuard Permit Instructions (Office PDF)
</a>
</p>

<p><small>Tool Version v1.0 (Verizon)</small></p>
</div>

<!-- FOOTER -->
<div class="footer">
<img src="matthew-urbanski.PNG" alt="Matthew Urbanski">
<p>
<strong>Tool created by:</strong><br>
Matthew Urbanski, Certified Field Inspector<br>
Matthew.Urbanski@AquaGuard.net<br>
470-568-1681
</p>
<p><small>
Internal decision-support tool for AquaGuard Foundation Solutions.<br>
Always verify parcel number and jurisdiction before contract execution.
</small></p>
</div>

</div>

<script>
function showTab(id,el){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  el.classList.add('active');
}

let lastDecision={};

function checkPermit(){
  const raw=document.getElementById("address").value.toLowerCase();
  const service=document.getElementById("service").value;
  const result=document.getElementById("result");
  const confWrap=document.getElementById("confidenceWrap");
  const confFill=document.getElementById("confidenceFill");
  const confText=document.getElementById("confidenceText");

  const cityMap={
    kennesaw:"Cobb",smyrna:"Cobb",marietta:"Cobb",
    canton:"Cherokee",woodstock:"Cherokee",
    atlanta:"Fulton","stone mountain":"DeKalb"
  };
  const zipMap={
    "30152":"Cobb","30080":"Cobb",
    "30115":"Cherokee",
    "30350":"Fulton","30339":"Fulton"
  };

  let county="",confidence=30,reason="";

  for(const c in cityMap){
    if(raw.includes(c)){
      county=cityMap[c];
      confidence=90;
      reason="City matched → County authority applied.";
      break;
    }
  }

  if(!county){
    const z=raw.match(/\b\d{5}\b/);
    if(z && zipMap[z[0]]){
      county=zipMap[z[0]];
      confidence=60;
      reason="ZIP matched → County inferred.";
    }
  }

  result.classList.remove("hidden");
  confWrap.classList.remove("hidden");
  confFill.style.width=confidence+"%";
  confText.textContent="Confidence: "+confidence+"%";

  if(!county){
    result.className="status maybe";
    result.innerHTML="<strong>Check / Try</strong><br>Jurisdiction unclear. Verify parcel via qPublic.";
    lastDecision={address:raw,service,decision:"Check / Try",county:"Unknown",confidence,reason};
    return;
  }

  if(service==="slab"){
    result.className="status no";
    result.innerHTML="<strong>No Permit Required</strong><br>Slab piers are exempt per AquaGuard policy.";
    lastDecision={address:raw,service,decision:"No Permit Required",county,confidence,reason:"Service exempt."};
    return;
  }

  result.className="status yes";
  result.innerHTML="<strong>Permit Required</strong><br>"+county+" County requires permits.";
  lastDecision={address:raw,service,decision:"Permit Required",county,confidence,reason};
}

function exportPDF(){
  const name=document.getElementById("inspName").value;
  const init=document.getElementById("inspInit").value;
  if(!name||!init){
    alert("Inspector name and initials are required for PDF export.");
    return;
  }
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();

  doc.setFontSize(16);
  doc.text("AquaGuard Permit Audit",20,20);

  doc.setFontSize(11);
  doc.text(
    "Inspector: "+name+" ("+init+") – Certified Field Inspector",
    20,
    32
  );
  doc.text("Generated: "+new Date().toLocaleString(),20,40);

  doc.line(20,44,190,44);

  doc.text("Address Input:",20,54);
  doc.text(lastDecision.address||"",20,62,{maxWidth:170});

  doc.text("Service:",20,80);
  doc.text(lastDecision.service||"",60,80);

  doc.text("County:",20,90);
  doc.text(lastDecision.county||"",60,90);

  doc.text("Decision:",20,100);
  doc.text(lastDecision.decision||"",60,100);

  doc.text("Confidence:",20,110);
  doc.text((lastDecision.confidence||"")+"%",60,110);

  doc.text("Reasoning:",20,120);
  doc.text(lastDecision.reason||"",20,128,{maxWidth:170});

  doc.save("AquaGuard_Permit_Audit.pdf");
}
</script>

</body>
</html>
